<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="CheckEventActionCountQuery">
		<![CDATA[

SELECT DISTINCT VSAC.VSAC_ACTION_ID,VSAC.ORG_ID,VSEL.VSEL_LISTENER_TYPE
FROM VS_ACTION VSAC,VS_LISTENER_ACTION VSLA
LEFT JOIN 
(SELECT VSEL.PM_CODE AS PM_CODE,VSEL.ORG_ID AS ORG_ID,VSEL.VSEL_LISTENER_TYPE AS VSEL_LISTENER_TYPE
FROM VS_EVENT_LISTENER VSEL,VS_EVENT_LISTENER_EVENT_GROUP VSES
LEFT JOIN 
(SELECT VSEG.VSEG_EVENT_OBJECT_TYPE AS VSEG_EVENT_OBJECT_TYPE,VSEG.ORG_ID AS ORG_ID,VSEG.PM_CODE AS PM_CODE
 FROM VS_EVENT_GROUP VSEG,VS_EVENT_GROUP_STATUS_CODE VSEC,VS_STATUS_CODE VSSC
WHERE 1=1
AND VSEG.PM_CODE=VSEC.VSEC_VSEG_PM_CODE AND VSSC.PM_CODE=VSEC.VSEC_VSSC_PM_CODE
<< AND VSSC.VSSC_STATUS_CODE_NAME IN (:vsscStatusCodeName) >>
<< AND VSEG.VSEG_EVENT_OBJECT_TYPE IN (:objectTypes) >>
<< AND VSEG.ORG_ID IN (:orgIds) >>
) VSEG
ON VSEG.PM_CODE=VSES.VSES_VSEG_PM_CODE
WHERE 1=1
AND VSEL.PM_CODE=VSES.VSES_VSEL_PM_CODE
AND VSEL.ORG_ID=VSEG.ORG_ID
AND VSEL.VSEL_LISTENER_TYPE=VSEG.VSEG_EVENT_OBJECT_TYPE
AND VSES.VSES_VSEG_PM_CODE=VSEG.PM_CODE) VSEL
ON VSEL.PM_CODE=VSLA.VSLA_VSEL_PM_CODE
WHERE 1=1
AND VSAC.VSAC_PARENT_PM_CODE=VSLA.VSLA_VSAC_PM_CODE
AND VSAC.ORG_ID=VSEL.ORG_ID

		]]>
	</sql-query>
</hibernate-mapping>
