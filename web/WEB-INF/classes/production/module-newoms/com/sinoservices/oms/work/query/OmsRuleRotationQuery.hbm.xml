<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="OmsRuleRotationQuery">
		<![CDATA[
	select DISTINCT
	cdrd.job_Id,      
	cdrd.project_Id,
	cdrd.rule_Code,
	cdrd.line_No,
	cdrd.lot_Att,
	cdrd.order_By,
	cdrd.rec_Ver,
	cdrd.creator,
	cdrd.create_Time,
	cdrd.modifier,
	cdrd.modify_Time,
	cdrd.rec_Status,
	cdrd.time_Zone,
	cdrd.org_Id,
	cdrd.site_Code,
	cdrd.company_Code,
	cdrd.wh_Code 
	from cd_wh_sku cws
	left join cd_owner_group_detail cdog on cdog.owner_group_code = cws.owner_group_code
	                                       and cdog.rec_status =0
  left join cd_rule_rotation_detail cdrd on cdrd.Rule_Code = cws.rotation_rule
                                  
										 and cdrd.rec_status =0
  left join cd_rule_rotation_header cdrh on cdrh.rule_code = cdrd.rule_code
	                        
											and cdrh.rec_status =0
	where 1=1
	 and (cdrh.Is_Public = 'Y'
	 
	  <<and cdog.owner_code = :ownerCode>>
	  <<and cws.sku_code = :skuCode>>   
	  <<and cdrh.rotation_type= :rotationType>>
	  
	 )or(cdrh.Is_Public = 'N'
	 
	<<and cws.company_code = :companyCode>>
	<<and cws.site_code = :siteCode>>
	<<and cws.wh_code = :whCode>>
	<<and cdog.owner_code = :ownerCode>>
	<<and cws.sku_code = :skuCode>>	 
	<<and cdrh.rotation_type= :rotationType>>
	
	)order by cdrd.LINE_NO
		]]>
	</sql-query>
</hibernate-mapping>
