<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="BatcchSetOrderIssuedQuantityUpdate">
		<![CDATA[
/*订单下发数量*/
UPDATE EO_ORDER EOOR 
		/*订单下发数量*/
   SET	EOOR.EOOR_ISSUED_QUANTITY = (SELECT	SUM(EOWO.EOWO_PACKAGE_QUANTITY) 
								   								FROM EO_WORK_ORDER EOWO
																WHERE EOOR.EOWO_ORDER_NO =EOWO.EOWO_ORDER_NO 
																AND EOWO.EOWO_IS_STARTING_TASK = 1  
		/*订单下发毛重*/														AND EOWO.EOWO_ISSUED_FLAG = '10'),
  		EOOR.EOOR_ISSUED_GROSS_WEIGHT = (SELECT SUM(EOWO.EOWO_GROSS_WEIGHT) 
								  								FROM EO_WORK_ORDER EOWO
																WHERE EOOR.EOWO_ORDER_NO =EOWO.EOWO_ORDER_NO
																AND EOWO.EOWO_IS_STARTING_TASK = 1  
		/*订单下发体积*/														AND EOWO.EOWO_ISSUED_FLAG = '10'),
		EOOR.EOOR_ISSUED_VOLUME = (SELECT SUM(EOWO.EOWO_VOLUME) 
																FROM EO_WORK_ORDER EOWO
																WHERE EOOR.EOWO_ORDER_NO =EOWO.EOWO_ORDER_NO
																AND EOWO.EOWO_IS_STARTING_TASK = 1  
																AND EOWO.EOWO_ISSUED_FLAG = '10')
	WHERE 1=1
		AND EOOR.EOOR_ORDER_NO IN (:orderNos)
		]]>
	</sql-query>
</hibernate-mapping>
