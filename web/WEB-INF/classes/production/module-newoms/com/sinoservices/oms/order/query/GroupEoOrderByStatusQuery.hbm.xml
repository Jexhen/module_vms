<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="GroupEoOrderByStatusQuery">
		<![CDATA[

select EOOR_STATUS_NAME,EOOR_STATUS_REMARK,EOOR_STATUS_CODE,count(*) as ROW_NUM  from (

SELECT 
EOOR.EOOR_ID,
NVL((CASE WHEN 'EN'=:showLanguage THEN EBCM.EBCD_NAME_EN WHEN 'ZH'=:showLanguage THEN EBCM.EBCD_NAME_CN ELSE EOOR.EOOR_STATUS_CODE END),EOOR.EOOR_STATUS_CODE) AS EOOR_STATUS_NAME,
EOOR.EOOR_STATUS_CODE,
EOOR.EOOR_STATUS_REMARK

 FROM EO_ORDER EOOR 
 LEFT JOIN EO_ORDER_BUSINESS EOOB ON EOOR.EOOR_ORDER_NO=EOOB.EOOR_ORDER_NO AND EOOR.ORG_ID=EOOB.ORG_ID
 <if is_not_empty(eooiCode) || is_not_empty(eooiName) || is_not_empty(eooiLotNo) || is_not_empty(eooiRemark) || is_not_empty(eooiTemperatureLevelCode) || is_not_empty(eooiTemperatureLevelName)>
  LEFT JOIN (SELECT EOOI.EOOI_ORDER_NO AS EOOI_ORDER_NO,EOOI.ORG_ID AS ORG_ID, COUNT(*) AS EOOI_COUNT FROM EO_ORDER_ITEM EOOI WHERE EOOI.REC_STATUS=0
  << AND EOOI.EOOI_CODE=:eooiCode >>
  << AND EOOI.EOOI_NAME like :eooiName >>
  << AND EOOI.EOOI_LOT_NO like :eooiLotNo >>
  << AND EOOI.EOOI_REMARK LIKE :eooiRemark >>
  << AND EOOI.EOOI_TEMPERATURE_LEVEL_CODE LIKE :eooiTemperatureLevelCode >>
  << AND EOOI.EOOI_TEMPERATURE_LEVEL_NAME LIKE :eooiTemperatureLevelName >>
  << AND EOOI.EOOI_ORDER_NO LIKE :eoorOrderNo >>
  << AND EOOI.EOOI_ORDER_NO IN (:eoorNos)>>
  << AND EOOI.ORG_ID=:orgId >>
  GROUP BY EOOI.EOOI_ORDER_NO,EOOI.ORG_ID
  ) EOOI ON EOOR.EOOR_ORDER_NO=EOOI.EOOI_ORDER_NO AND EOOR.ORG_ID=EOOI.ORG_ID
 </if>
 LEFT JOIN ES_USER ESUS ON EOOR.CREATOR=ESUS.ESUS_ID
 << AND ESUS.ESUS_USER_NAME_CN LIKE :esusUserNameCn>>
 << AND ESUS.ESUS_LOGIN_NAME LIKE :esusLoginName>>
/* LEFT JOIN VS_STATUS_CODE VSSC ON EOOR.EOOR_EVENT_STATUS_CODE=VSSC.VSSC_STATUS_CODE_NAME AND EOOR.ORG_ID=VSSC.ORG_ID */
 LEFT JOIN EB_CODE_MASTER EBCM ON EBCM.EBCD_CODE=EOOR.EOOR_STATUS_CODE AND  EBCM.EBCD_DICTIONARY_TYPE='SYS_OMS_DIVIDE_ORDER_STATUS'
WHERE 1=1
AND EOOR.REC_STATUS=0
<< AND EOOR.ORG_ID =:orgId >>
<< AND EOOR.EOOR_ID LIKE :eoorId >>
<< AND EOOR.EOOR_ID IN (:eoorIds) >>
<< AND EOOR.EOOR_ORDER_NO LIKE :eoorOrderNo >>
<< AND EOOR.EOOR_LOGISTIC_NO LIKE :eoorLogisticNo >>
<< AND EOOB.EOOR_SO_NO LIKE :eoorSoNo >>
<< AND EOOB.EOOR_DO_NO LIKE :eoorDoNo >>
<< AND EOOB.EOOR_PO_NO LIKE :eoorPoNo >>
<< AND EOOB.EOOR_REQUIREMENT LIKE :eoorRequirement >>
<< AND EOOR.EOOR_REMARK LIKE :eoorRemark >>
<< AND EOOR.EOOR_ORDER_TYPE_CODE LIKE :eoorOrderTypeCode >>
<< AND EOOR.EOOR_ORDER_TYPE_NAME like :eoorOrderTypeName >>
<< AND EOOR.EOOR_PRIORITY_CODE LIKE :eoorPriority >>
<< AND EOOR.EOOR_TRANS_TYPE_CODE LIKE :eoorTransTypeCode >>
<< AND EOOR.EOOR_STATUS_CODE LIKE :eoorStatusCode >>
<< AND EOOR.EOOR_STATUS_Name like :eoorStatusName >>
<< AND EOOB.EOOR_CUSTOMER_CODE LIKE :eoorCustomerCode >>
<< AND EOOB.EOOR_CUSTOMER_NAME like :eoorCustomerName >>
<< AND EOOB.EOOR_CUSTOMER_CONTACT_CODE LIKE :eoorCustomerContactCode >>
<< AND EOOB.EOOR_CUSTOMER_CONTACT_NAME like :eoorCustomerContactName >>
<< AND EOOB.EOOR_CUSTOMER_CONTACT_PHONE LIKE :eoorCustomerContactPhone >>
<< AND EOOB.EOOR_SELLING_CUSTOMER_CODE LIKE :eoorSellingCustomerCode >>
<< AND EOOB.EOOR_SELLING_CUSTOMER_NAME LIKE :eoorSellingCustomerName >>
<< AND EOOB.EOOR_ORDER_TIME >= :eoorOrderTimeFrom >>
<< AND EOOB.EOOR_ORDER_TIME <= :eoorOrderTimeTo >>
<< AND EOOR.EOOR_SOURCE_CODE = :eoorSourceCode >>
<< AND EOOB.EOOR_REQUIRE_SHIPPER_TIME_TO >= :eoorRequireShipperTimeFrom >>
<< AND EOOB.EOOR_REQUIRE_SHIPPER_TIME_FM <= :eoorRequireShipperTimeTo >>
<< AND EOOB.EOOR_REQUIRE_SHIPPER_TIME_FM >= :requireShipperTimeFm>>
<< AND EOOB.EOOR_REQUIRE_SHIPPER_TIME_FM <= :requireShipperTimeTo>>
<< AND EOOB.EOOR_REQUIRE_SHIPPER_TIME_TO >= :requireShipperTimeFm2 >>
<< AND EOOB.EOOR_REQUIRE_SHIPPER_TIME_TO <= :requireShipperTimeTo2 >>
<< AND EOOB.EOOR_REQUIRE_CONSIGNEE_TIME_TO >= :eoorRequireConsigneeTimeFrom >>
<< AND EOOB.EOOR_REQUIRE_CONSIGNEE_TIME_FM <= :eoorRequireConsigneeTimeTo >>
<< AND EOOB.EOOR_REQUIRE_CONSIGNEE_TIME_FM >= :requireConsigneeTimeFm >>
<< AND EOOB.EOOR_REQUIRE_CONSIGNEE_TIME_FM <= :requireConsigneeTimeTo >>
<< AND EOOB.EOOR_REQUIRE_CONSIGNEE_TIME_TO >= :requireConsigneeTimeFm2 >>
<< AND EOOB.EOOR_REQUIRE_CONSIGNEE_TIME_TO <= :requireConsigneeTimeTo2 >>
<< AND EOOR.EOOR_ORDER_DEPARTMENT_CODE LIKE :eoorOrderDepartmentCode >>
<< AND EOOR.EOOR_ORDER_DEPARTMENT_NAME like :eoorOrderDepartmentName >>
<< AND EOOR.EOOR_OPERATE_DEPARTMENT_CODE LIKE :eoorOperateDepartmentCode >>
<< AND EOOR.EOOR_OPERATE_DEPARTMENT_NAME like :eoorOperateDepartmentName >>
<< AND EOOR.EOOR_DIVIDE_CODE LIKE :eoorDivideCode >>
<< AND EOOR.EOOR_DIVIDE_NAME like :eoorDivideName >>
<< AND EOOR.EOOR_BARCODE LIKE :eoorBarcode >>
<< AND EOOB.EOOR_SHIPPER_CODE LIKE :eoorShipperCode >>
<< AND EOOB.EOOR_SHIPPER_NAME like :eoorShipperName >>
<< AND EOOB.EOOR_SHIPPER_CONTACT_CODE LIKE :eoorShipperContactCode >>
<< AND EOOB.EOOR_SHIPPER_CONTACT_NAME like :eoorShipperContactName >>
<< AND EOOB.EOOR_SHIPPER_CONTACT_PHONE LIKE :eoorShipperContactPhone >>
<< AND EOOB.EOOR_SHIPPER_LOCATION_CODE LIKE :eoorShipperLocationCode >>
<< AND EOOB.EOOR_SHIPPER_LOCATION_NAME like :eoorShipperLocationName >>
<< AND EOOB.EOOR_SHIPPER_REGION_CODE LIKE :eoorShipperRegionCode >>
<< AND EOOB.EOOR_SHIPPER_REGION_NAME like :eoorShipperRegionName >>
<< AND EOOB.EOOR_CONSIGNEE_CODE LIKE :eoorConsigneeCode >>
<< AND EOOB.EOOR_CONSIGNEE_NAME like :eoorConsigneeName >>
<< AND EOOB.EOOR_CONSIGNEE_CONTACT_CODE LIKE :eoorConsigneeContactCode >>
<< AND EOOB.EOOR_CONSIGNEE_CONTACT_NAME like :eoorConsigneeContactName >>
<< AND EOOB.EOOR_CONSIGNEE_CONTACT_PHONE LIKE :eoorConsigneeContactPhone >>
<< AND EOOB.EOOR_CONSIGNEE_LOCATION_CODE LIKE :eoorConsigneeLocationCode >>
<< AND EOOB.EOOR_CONSIGNEE_LOCATION_NAME like :eoorConsigneeLocationName >>
<< AND EOOB.EOOR_CONSIGNEE_REGION_CODE LIKE :eoorConsigneeRegionCode >>
<< AND EOOB.EOOR_CONSIGNEE_REGION_NAME like :eoorConsigneeRegionName >>
<if eoorMegerFlag=='T'>
   AND nvl(EOOR.EOOR_MEGER_FLAG,'T') =:eoorMegerFlag
</if>
<if eoorMegerFlag=='N'>
   AND nvl(EOOR.EOOR_MEGER_FLAG,'N') =:eoorMegerFlag
</if>
<if eoorMegerFlag=='Y'>
   AND EOOR.EOOR_MEGER_FLAG =:eoorMegerFlag
</if>
<if eoorMegerFlag=='Q'>
   AND EOOR.EOOR_MEGER_FLAG ='N'
</if>
<if eoorSplitFlag=='Q'>
	AND EOOR.EOOR_SPLIT_FLAG IS NULL
</if>
<if eoorSplitFlag=='N'>
	AND nvl(EOOR.EOOR_SPLIT_FLAG,'N') =:eoorSplitFlag
</if>
<#if showOriginalOrder == 'N'>
   AND NVL(EOOR.EOOR_MEGER_FLAG, 'N') != 'Y'
   AND NVL(EOOR.EOOR_SPLIT_FLAG, 'N') != 'Y'
</#if>
<< AND EOOR.EOOR_LINK_ORDER_NO =:eoorLinkOrderNo>>
<< AND EOOB.EOOR_EXPIRATION_TIME>=:eoorExpirationTimeFrom>>
<< AND EOOB.EOOR_EXPIRATION_TIME<=:eoorExpirationTimeTo>>
<< AND EOOB.EOOR_RESERVATION like :eoorReservation >>
<< AND EOOR.EOOR_SALESMAN_CODE like :eoorSalesmanCode >>
<< AND EOOR.EOOR_SALESMAN_NAME like :eoorSalesmanName >>
<< AND EOOB.EOOR_EMERGENT_FLAG like :eoorEmergentFlag >>

<if is_not_empty(eooiCode) || is_not_empty(eooiName) || is_not_empty(eooiLotNo) || is_not_empty(eooiRemark) || is_not_empty(eooiTemperatureLevelCode) || is_not_empty(eooiTemperatureLevelName)>
  AND NVL(EOOI.EOOI_COUNT,0)>0
 </if>


<< AND EOOR.EOOR_ORDER_NO IN (:eoorNos)>>
<< AND EOOB.EOOR_PAYMENT_TYPE_CODE LIKE :eoorPaymentTypeCode >>
<< AND EOOB.EOOR_PAYMENT_TYPE_NAME LIKE :eoorPaymentTypeName >>
<< AND EOOB.EOOR_WAREHOUSER_CODE LIKE :eoorWarehouserCode>>
<< AND EOOB.EOOR_WAREHOUSER_NAME LIKE :eoorWarehouserName>>
<< AND EOOB.EOOR_STATION_CODE LIKE :eoorStationCode >>
<< AND EOOB.EOOR_STATION_NAME LIKE :eoorStationName >>
<< AND EOOR.CREATOR LIKE :esusLoginName>>
<< AND EOOB.EOOR_EOSM_PM_CODE LIKE :eoorEosmPmCode>>
<< AND EOOB.EOOR_EOSM_NAME LIKE :eoorEosmName >>
AND (##CONDITIONS$EO_ORDER$EOOR##)
) group by EOOR_STATUS_NAME,EOOR_STATUS_REMARK,EOOR_STATUS_CODE

		]]>
	</sql-query>
</hibernate-mapping>
