<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="PopOmsGetCityByCtyAndProvinceQuery">
		<![CDATA[

select ebpm.EBPL_ID,
ebpm.EBPL_PARENT_PM_CODE,
ebpm.EBPL_TYPE,
ebpm.EBPL_CODE,
ebpm.EBPL_QUICK_CODE,
ebpm.EBPL_NAME_CN,
ebpm.EBPL_NAME_EN,
ebpm.EBPL_POST_CODE,
ebpm.EBPL_IS_ABLE,
ebpm.EBPL_STATION_CODE,
ebpm.EBPL_STATION_NAME,
ebpm.MODIFY_TIME,
eb_country.EBPL_CODE COUNTRY_CODE,
eb_country.EBPL_NAME_CN COUNTRY_NAME_CN,
eb_country.EBPL_NAME_EN COUNTRY_NAME_EN,
eb_province.EBPL_CODE PROVINCE_CODE,
eb_province.EBPL_NAME_CN PROVINCE_NAME_CN,
eb_province.EBPL_NAME_EN PROVINCE_NAME_EN
from EB_PLACE eb_country
left join EB_PLACE eb_province
on eb_province.ebpl_type='PLACE_PROVINCE' and eb_province.ebpl_is_able='ENABLE'
and eb_country.EBPL_CODE=eb_province.EBPL_PARENT_PM_CODE
<<and eb_province.ebpl_code = :provinceCode>>
left join EB_PLACE ebpm
on ebpm.ebpl_type='PLACE_CITY' and ebpm.ebpl_is_able='ENABLE'
and eb_province.EBPL_CODE=ebpm.EBPL_PARENT_PM_CODE
where eb_country.ebpl_type='PLACE_COUNTRY' and eb_country.ebpl_is_able='ENABLE'
<<and eb_country.ebpl_code LIKE :countryCode>>
and ebpm.EBPL_CODE is not null and ebpm.EBPL_IS_ABLE='ENABLE'
  	 <if is_empty(ebplCode,ebplNameCn,ebplNameEn) == false >
		and (1=2
<<or ebpm.ebpl_code like '%' || :ebplCode || '%'>>
<<or ebpm.EBPL_NAME_CN like '%' || :ebplNameCn || '%'>>
<<or ebpm.EBPL_NAME_EN like '%' || :ebplNameEn || '%'>>
		)
 	</if>
		]]>
	</sql-query>
</hibernate-mapping>
