<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="PopOmsCdCustomerContactQuery">
		<![CDATA[

SELECT 
DISTINCT
EBCC.EBCC_CONTACT_NO,
EBCC.EBCC_CONTACT_NAME,
EBCC.EBCC_VISCOUNTSHIP,
EBCC.EBCC_MOBILE,
EBCC.EBCC_TEL,
EBCC.EBCC_EMAIL,
EBCC.EBCC_FAX,
EBCC.EBCC_REMARK,
EBCC.EBCC_ID,
EBCC.EBCC_EBCU_PM_CODE,
EBCC.EBCC_IS_DEFAULT,
EBCC.CREATOR,
EBCC.CREATE_TIME,
EBCC.MODIFIER,
EBCC.MODIFY_TIME,
EBCC.REC_VER,
EBCC.EBCC_REQ_APPOINTMENT,
CDCC.CDCC_ID,
CDCC.CDCC_CONTACT_NO,
CDCC.CDCC_CONTACT_NAME,
CDCC.CDCC_LOCATION,
CDCC.CDCC_USER_ID,
CDCC.CDCC_CALENDAR_CODE,
CDCC.CDCC_EQUIPMENT_GROUP,
CDCC.CDCC_VEHICLE,
CDCC.CDCC_DRIVER,
CDCC.REC_VER AS CDCC_REC_VER,
CDCC.CREATE_TIME AS CDCC_CREATE_TIME,
CDCC.CREATOR AS CDCC_CREATOR,
CDCC.MODIFY_TIME AS CDCC_MODIFY_TIME,
CDCC.MODIFIER AS CDCC_MODIFIER,
EBLC.EBLC_CODE,
EBLC.EBLC_NAME_CN,
EBLC.EBLC_ADDRESS,
EBCU.PM_CODE,
EBCU.EBCU_NAME_CN
FROM EB_CUSTOMER_CONTACT EBCC
LEFT JOIN EB_CUSTOMER EBCU ON EBCU.PM_CODE = EBCC.EBCC_EBCU_PM_CODE AND EBCU.EBCU_IS_CUSTOMER = 'Y' AND EBCU.ORG_ID = EBCC.ORG_ID
LEFT JOIN EB_CUSTOMER_ROLE EBCR ON EBCR.EBCR_EBCU_PM_CODE = EBCU.PM_CODE AND EBCR.EBCR_ROLE_CODE IN ('SHIPPER', 'CONSIGNEE') AND EBCR.ORG_ID = EBCU.ORG_ID
LEFT JOIN CD_TS_CUSTOMER_CONTACT CDCC ON CDCC.CDCC_CUSTOMER_NO = EBCU.PM_CODE AND CDCC.CDCC_CONTACT_NAME = EBCC.EBCC_CONTACT_NAME AND EBCU.ORG_ID = CDCC.ORG_ID
LEFT JOIN EB_LOCATION EBLC ON EBLC.EBLC_CODE = CDCC.CDCC_LOCATION AND EBLC.ORG_ID = CDCC.ORG_ID
WHERE 1=1
<< AND EBCU.ORG_ID = :orgId >>
<< AND CDCC.CDCC_CUSTOMER_NO LIKE '%' || :cdccCustomerNo || '%'>>
<< AND EBCC.EBCC_CONTACT_NO LIKE '%' || :ebccContactNo || '%'>>
<< AND EBCC.EBCC_CONTACT_NAME like '%' || :ebccContactName || '%' >>
<< AND EBCC.EBCC_MOBILE like '%' || :ebccMobile || '%' >>
<< AND EBLC.EBLC_ADDRESS like '%' || :eblcAddress || '%'>>
<< AND EBCC.EBCC_TEL like '%' || :ebccTel || '%'>>
<< AND EBCC.EBCC_EMAIL like '%' || :ebccEmail || '%'>>
<< AND EBCC.EBCC_EBCU_PM_CODE LIKE '%' || :ebccEbcuPmCode || '%'>>
<< AND EBCR.EBCR_ROLE_CODE LIKE '%' || :customerRole || '%'>>
<<and EBLC.EBLC_CODE LIKE '%' || :eblcCode || '%'>>
<<and EBLC.EBLC_NAME_CN like '%' || :eblcNameCn || '%'>>
<<and EBCU.PM_CODE LIKE '%' || :ebcuPmCode || '%'>>
<<AND EBLC.EBLC_ADDRESS IN (:eblcAddressLst)>>
ORDER BY EBCC.MODIFY_TIME DESC

		]]>
	</sql-query>
</hibernate-mapping>
