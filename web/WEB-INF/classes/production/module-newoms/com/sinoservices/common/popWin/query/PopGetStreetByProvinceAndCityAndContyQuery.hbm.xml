<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="PopGetStreetByProvinceAndCityAndContyQuery">
		<![CDATA[

select ebpm.EBPL_ID,
ebpm.EBPL_PARENT_PM_CODE,
ebpm.EBPL_TYPE,
ebpm.EBPL_CODE,
ebpm.EBPL_QUICK_CODE,
ebpm.EBPL_NAME_CN,
ebpm.EBPL_NAME_EN,
ebpm.EBPL_POST_CODE,
ebpm.EBPL_IS_ABLE,
ebpm.EBPL_STATION_CODE,
ebpm.EBPL_STATION_NAME,
ebpm.MODIFY_TIME,
eb_province.EBPL_CODE PROVINCE_CODE,
eb_province.EBPL_NAME_CN PROVINCE_NAME_CN,
eb_province.EBPL_NAME_EN PROVINCE_NAME_EN,
eb_city.EBPL_CODE CITY_CODE,
eb_city.EBPL_NAME_CN CITY_NAME_CN,
eb_city.EBPL_NAME_EN CITY_NAME_EN,
eb_district.EBPL_CODE county_Code,
eb_district.EBPL_NAME_CN county_name_cn,
eb_district.EBPL_NAME_EN county_name_EN
from EB_PLACE eb_province
left join EB_PLACE eb_city
on eb_city.ebpl_type='PLACE_CITY' /* and eb_city.ebpl_is_able='ENABLE' */
and eb_province.EBPL_CODE=eb_city.EBPL_PARENT_PM_CODE
<<and eb_city.ebpl_code = :cityCode>>

left join EB_PLACE eb_district
on eb_district.ebpl_type='PLACE_DISTRICT' /*  and eb_district.ebpl_is_able='ENABLE' */
and eb_city.EBPL_CODE=eb_district.EBPL_PARENT_PM_CODE
<<and eb_district.ebpl_code = :districtCode>>

left join EB_PLACE ebpm
on ebpm.ebpl_type='PLACE_STREET' /*  and ebpm.ebpl_is_able='ENABLE' */
and eb_district.EBPL_CODE=ebpm.EBPL_PARENT_PM_CODE
<<and ebpm.ebpl_code = :streetCode>>

where eb_province.ebpl_type='PLACE_PROVINCE' /*  and eb_province.ebpl_is_able='ENABLE'  */
and ebpm.EBPL_CODE is not null
<<and eb_province.ebpl_code LIKE :provinceCode>>
 <if is_empty(ebplCode,ebplNameCn,ebplNameEn) == false >
and (1=2
<<or ebpm.ebpl_code like '%' || :ebplCode || '%'>>
<<or ebpm.EBPL_NAME_CN like '%' || :ebplNameCn || '%'>>
<<or ebpm.EBPL_NAME_EN like '%' || :ebplNameEn || '%'>>
)
</if> 
		]]>
	</sql-query>
</hibernate-mapping>
